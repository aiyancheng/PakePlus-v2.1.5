<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¢æˆ·ç®¡ç†ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            overflow: hidden; /* é˜²æ­¢å‡ºç°æ»šåŠ¨æ¡ */
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
        }

        .container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        /* é¦–é¡µæ ·å¼ */
        #index-page {
            display: none;
            flex: 1;
            flex-direction: column;
            padding: 20px;
            overflow: auto;
        }

        #index-page.active {
            display: flex;
        }

        .page-title {
            text-align: center;
            font-size: 28px;
            margin-bottom: 30px;
            color: #333;
            padding: 10px 0;
        }

        .stores-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            flex: 1;
            padding: 0 20px 20px 20px;
            overflow-y: auto;
        }

        .store-btn {
            padding: 20px 15px;
            background-color: #e0e0e0;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            transition: background-color 0.3s;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .store-btn:hover {
            background-color: #c0c0c0;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .footer {
            text-align: center;
            padding: 20px;
            background-color: #f9f9f9;
            border-top: 1px solid #ddd;
        }

        .footer-btn {
            padding: 12px 25px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        .footer-btn:hover {
            background-color: #005cbf;
        }

        /* è¯¦æƒ…é¡µæ ·å¼ */
        #detail-page {
            display: none;
            flex: 1;
            flex-direction: column;
        }

        #detail-page.active {
            display: flex;
        }

        .detail-header {
            text-align: center;
            font-size: 24px;
            padding: 15px 20px;
            color: #333;
            background-color: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            flex-shrink: 0;
        }

        .detail-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 280px;
            background-color: #f8f9fa;
            border-right: 1px solid #dee2e6;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .sidebar.collapsed {
            width: 60px;
        }

        .sidebar-title {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin: 15px 0;
            color: #333;
            padding-bottom: 10px;
            border-bottom: 1px solid #dee2e6;
        }

        .collapsed .sidebar-title {
            display: none;
        }

        .sidebar-nav {
            flex: 1;
            overflow-y: auto;
            padding: 10px 0;
        }

        .collapsed .sidebar-nav {
            padding: 10px 0;
        }

        .sidebar-btn {
            display: block;
            width: 100%;
            padding: 16px;
            background-color: #e9ecef;
            border: none;
            border-left: 4px solid transparent;
            cursor: pointer;
            font-size: 16px;
            text-align: left;
            transition: all 0.3s;
            margin-bottom: 5px;
        }

        .collapsed .sidebar-btn {
            padding: 16px 5px;
            text-align: center;
            font-size: 12px;
        }

        .sidebar-btn:hover {
            background-color: #dcdcdc;
        }

        .sidebar-btn.active {
            background-color: #007bff;
            color: white;
            border-left-color: #005cbf;
        }

        .collapsed .sidebar-btn.active {
            border-left-color: #007bff;
        }

        .sidebar-btn span.text {
            display: inline-block;
        }

        .collapsed .sidebar-btn span.text {
            display: none;
        }

        .sidebar-btn span.icon {
            display: inline-block;
            width: 20px;
            text-align: center;
        }

        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .document-frame {
            flex: 1;
            width: 100%;
            border: none;
            min-height: 0; /* å…è®¸flexå­é¡¹æ”¶ç¼© */
            /* å…³é”®ä¼˜åŒ–ï¼šå…è®¸è·¨åŸŸå†…å®¹ */
            sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation"
        }

        .error-message {
            flex: 1;
            padding: 30px;
            text-align: center;
            color: #d9534f;
            font-size: 18px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .link-button {
            display: inline-block;
            padding: 12px 25px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            margin-top: 20px;
            transition: background-color 0.3s;
        }

        .link-button:hover {
            background-color: #005cbf;
        }

        .hidden {
            display: none;
        }
        
        /* è¿”å›ä¸»é¡µé“¾æ¥æ ·å¼ */
        .back-to-home {
            display: block;
            width: calc(100% - 4px);
            padding: 18px;
            background-color: #e6e6e6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            margin: 2px;
            text-align: center;
            text-decoration: none;
        }
        
        .back-to-home:hover {
            background-color: #c0c0c0;
        }

        .toggle-sidebar-btn {
            position: absolute;
            top: 20px;
            right: -30px;
            width: 30px;
            height: 40px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 0 4px 4px 0;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .toggle-sidebar-btn:hover {
            background-color: #005cbf;
        }
        
        /* åŠ è½½æŒ‡ç¤ºå™¨ */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            font-size: 18px;
            color: #666;
        }
        
        /* å“åº”å¼è®¾è®¡ - å¹³æ¿è®¾å¤‡ */
        @media (max-width: 1024px) {
            .sidebar {
                width: 220px;
            }
            
            .stores-container {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }
        
        /* å“åº”å¼è®¾è®¡ - å°å±è®¾å¤‡ */
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }
            
            .stores-container {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
                gap: 15px;
            }
            
            .store-btn {
                padding: 16px 12px;
                font-size: 16px;
            }
            
            .detail-header {
                font-size: 20px;
                padding: 12px 15px;
            }
            
            .sidebar-btn {
                padding: 14px;
                font-size: 15px;
            }
        }
        
        /* å“åº”å¼è®¾è®¡ - æ‰‹æœºè®¾å¤‡ */
        @media (max-width: 480px) {
            .sidebar {
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 1px solid #dee2e6;
            }
            
            .detail-content {
                flex-direction: column;
            }
            
            .stores-container {
                grid-template-columns: 1fr;
                padding: 0 10px 10px 10px;
            }
            
            .store-btn {
                padding: 18px 15px;
                font-size: 18px;
            }
            
            .page-title {
                font-size: 24px;
            }
            
            .detail-header {
                font-size: 18px;
                padding: 10px 15px;
            }
            
            .sidebar-title {
                font-size: 16px;
                margin: 10px 0;
            }
            
            .sidebar-btn {
                padding: 15px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¦–é¡µ -->
        <div id="index-page" class="active">
            <h1 class="page-title">å®¢æˆ·ç®¡ç†</h1>
            <div class="stores-container">
                <button class="store-btn" data-store="å¾å®¶äº•åº—">å¾å®¶äº•åº—</button>
                <button class="store-btn" data-store="é»„å¤å±±åº—">é»„å¤å±±åº—</button>
                <button class="store-btn" data-store="çœ¼ç§‘è¯Šæ‰€åº—">çœ¼ç§‘è¯Šæ‰€åº—</button>
                <button class="store-btn" data-store="æ—¶ä»£æ—ºè§’åº—">æ—¶ä»£æ—ºè§’åº—</button>
                <button class="store-btn" data-store="ä¸œå±±æ™¯åŒºåº—">ä¸œå±±æ™¯åŒºåº—</button>
                <button class="store-btn" data-store="æ˜¥å¤©å¹¿åœºåº—">æ˜¥å¤©å¹¿åœºåº—</button>
                <button class="store-btn" data-store="è‹é€šå›½é™…åº—">è‹é€šå›½é™…åº—</button>
                <button class="store-btn" data-store="ä¸‡è¾¾åº—">ä¸‡è¾¾åº—</button>
                <button class="store-btn" data-store="æ„¿æ™¯å›½é™…åº—">æ„¿æ™¯å›½é™…åº—</button>
                <button class="store-btn" data-store="æ–°å¤©åœ°åº—">æ–°å¤©åœ°åº—</button>
                <button class="store-btn" data-store="ç™½ç«¹æ¹–åº—">ç™½ç«¹æ¹–åº—</button>
                <button class="store-btn" data-store="ç½—å£é—¨åº—">ç½—å£é—¨åº—</button>
                <button class="store-btn" data-store="ä¸‡è”åº—">ä¸‡è”åº—</button>
                <button class="store-btn" data-store="ç¥é˜³çœ¼ç§‘åº—">ç¥é˜³çœ¼ç§‘åº—</button>
            </div>
            <div class="footer">
                <button class="footer-btn">åˆ·æ–°é¡µé¢</button>
            </div>
        </div>

        <!-- è¯¦æƒ…é¡µ -->
        <div id="detail-page">
            <h1 class="detail-header" id="detail-title">é—¨åº—å®¢æˆ·ç®¡ç†ç³»ç»Ÿ</h1>
            <div class="detail-content">
                <div class="sidebar" id="sidebar">
                    <button class="toggle-sidebar-btn" id="toggle-sidebar">Â«</button>
                    <div class="sidebar-title" id="sidebar-title">åŠŸèƒ½èœå•</div>
                    <div class="sidebar-nav">
                        <button class="sidebar-btn active" data-section="add-customer">
                            <span class="icon">ğŸ“</span>
                            <span class="text">æ–°å¢å®¢æˆ·ç™»è®°</span>
                        </button>
                        <button class="sidebar-btn" data-section="follow-up">
                            <span class="icon">ğŸ“</span>
                            <span class="text">å½“æ—¥å›è®¿å®¢æˆ·</span>
                        </button>
                        <button class="sidebar-btn" data-section="review">
                            <span class="icon">ğŸ“‹</span>
                            <span class="text">å¤æŸ¥è®°å½•ç®¡ç†</span>
                        </button>
                        <button class="sidebar-btn" data-section="todo">
                            <span class="icon">âœ…</span>
                            <span class="text">å¾…åŠäº‹é¡¹</span>
                        </button>
                        <a href="index.html" class="back-to-home" target="_self">ğŸ  è¿”å›ä¸»é¡µ</a>
                    </div>
                </div>
                <div class="content-area">
                    <iframe id="document-frame" class="document-frame" src="about:blank"></iframe>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å­˜å‚¨å½“å‰é€‰æ‹©çš„é—¨åº—
        let currentStore = localStorage.getItem('selectedStore') || '';
        
        // Kdocsé“¾æ¥æ˜ å°„ - ä¿®å¤åçš„é“¾æ¥
        const CUSTOMER_LINKS = {
            "å¾å®¶äº•åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/wo/sl/v1NAdNF", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v141QvA8", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/OqwUEQOC", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "é»„å¤å±±åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/wo/sl/v1PKC2", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v1CCE4R", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/6plLcMnU", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "çœ¼ç§‘è¯Šæ‰€åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/wo/sl/v11BB51C", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v1lHuBv", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/Jt0Uzaok", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "æ—¶ä»£æ—ºè§’åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/l/cnD1vN2ewxwH", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v1UvVo4", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/F3yfrMLJ", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "ä¸œå±±æ™¯åŒºåº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/l/cuQaE92E4JTb", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v14M4G51", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/Y3voQn8B", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "æ˜¥å¤©å¹¿åœºåº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/l/cttPVJlz6wvX", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v12jciOV", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/04UYAPH9", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "è‹é€šå›½é™…åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/wo/sl/v1WnUUM", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v14NS4y2", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/kmYQlhnH", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "ä¸‡è¾¾åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/wo/sl/v14T9Pyw", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v15L1mS", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/jWwg9dDi", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "æ„¿æ™¯å›½é™…åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/wo/sl/v12vJw5z", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v121KRe3", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/QZFcAnu7", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "æ–°å¤©åœ°åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/wo/sl/v12zQIdM", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v11BemYj", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/qdSX43oX", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "ä¸‡è”åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/wo/sl/v12msbCv", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v13Rx5IH", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/blubZh3e", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "ç½—å£é—¨åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/wo/sl/v1RKC2L", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v130xxzy", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/npREjTc4", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "ç™½ç«¹æ¹–åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/wo/sl/v13UjoGr", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v11N8yOp", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/zAXn08IF", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ],
            "ç¥é˜³çœ¼ç§‘åº—": [
                { name: "ğŸ“ æ–°å¢å®¢æˆ·ç™»è®°", url: "https://www.kdocs.cn/wo/sl/v11ozRE6", desc: "ç™»è®°æ–°å®¢æˆ·ä¿¡æ¯" },
                { name: "ğŸ“ å½“æ—¥å›è®¿å®¢æˆ·", url: "https://www.kdocs.cn/wo/sl/v1449R6E", desc: "å®‰æ’ä»Šæ—¥å›è®¿è®¡åˆ’" },
                { name: "ğŸ“‹ å¤æŸ¥è®°å½•ç®¡ç†", url: "https://www.kdocs.cn/etapps/query/q/eQoLfNHB", desc: "ç®¡ç†å®¢æˆ·å¤æŸ¥è®°å½•" }
            ]
        };

        // WPSå¾…åŠäº‹é¡¹é“¾æ¥æ˜ å°„
        const TODO_LINKS = {
            "å¾å®¶äº•åº—": "https://rili.wps.cn/c/g_w2kRPF9e/",
            "é»„å¤å±±åº—": "https://rili.wps.cn/c/g_O3ASj7Wz/",
            "çœ¼ç§‘è¯Šæ‰€åº—": "https://rili.wps.cn/c/g_RhugkyXw/",
            "æ—¶ä»£æ—ºè§’åº—": "https://rili.wps.cn/c/g_WgmmTCGW/",
            "ä¸œå±±æ™¯åŒºåº—": "https://rili.wps.cn/c/g_bjhMBaAh/",
            "æ˜¥å¤©å¹¿åœºåº—": "https://rili.wps.cn/c/g_dYwK9qr4/",
            "è‹é€šå›½é™…åº—": "https://rili.wps.cn/c/g_NQOxfDGE/",
            "ä¸‡è¾¾åº—": "https://rili.wps.cn/c/g_l9ppWcIt/",
            "æ„¿æ™¯å›½é™…åº—": "https://rili.wps.cn/c/g_Zd5w1bts/",
            "æ–°å¤©åœ°åº—": "https://rili.wps.cn/c/g_V0WRv6cx/",
            "ç™½ç«¹æ¹–åº—": "https://rili.wps.cn/c/g_rrZjd8gZ/",
            "ç½—å£é—¨åº—": "https://rili.wps.cn/c/g_AU4dcLyW/",
            "ä¸‡è”åº—": "https://rili.wps.cn/c/g_HvRRCEMr/",
            "ç¥é˜³çœ¼ç§‘åº—": "https://rili.wps.cn/c/g_Zd5w1bts/"
        };

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            
            // åˆ·æ–°é¡µé¢æŒ‰é’®äº‹ä»¶
            document.querySelector('.footer-btn').addEventListener('click', function() {
                location.reload();
            });
        });
        
        function initializeApp() {
            setupEventListeners();
            updatePageBasedOnState();
        }
        
        function setupEventListeners() {
            // é—¨åº—é€‰æ‹©æŒ‰é’®äº‹ä»¶
            const storeButtons = document.querySelectorAll('.store-btn');
            storeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const storeName = this.getAttribute('data-store');
                    selectStore(storeName);
                });
            });
            
            // è¯¦æƒ…é¡µä¾§è¾¹æ æŒ‰é’®äº‹ä»¶
            const sidebarButtons = document.querySelectorAll('.sidebar-btn:not(.back-to-home)');
            sidebarButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.getAttribute('data-section');
                    activateSection(section);
                });
            });
            
            // ä¾§è¾¹æ åˆ‡æ¢æŒ‰é’®äº‹ä»¶
            document.getElementById('toggle-sidebar').addEventListener('click', toggleSidebar);
        }
        
        function selectStore(storeName) {
            localStorage.setItem('selectedStore', storeName);
            currentStore = storeName;
            showDetailPage();
        }
        
        function showIndexPage() {
            document.getElementById('index-page').classList.add('active');
            document.getElementById('detail-page').classList.remove('active');
            document.title = 'å®¢æˆ·ç®¡ç†ç³»ç»Ÿ';
            // æ¸…é™¤å½“å‰é—¨åº—é€‰æ‹©
            currentStore = '';
            localStorage.removeItem('selectedStore');
        }
        
        function showDetailPage() {
            document.getElementById('index-page').classList.remove('active');
            document.getElementById('detail-page').classList.add('active');
            document.getElementById('detail-title').textContent = `${currentStore}å®¢æˆ·ç®¡ç†ç³»ç»Ÿ`;
            document.getElementById('sidebar-title').textContent = `${currentStore}åŠŸèƒ½èœå•`;
            document.title = `${currentStore}å®¢æˆ·ç®¡ç†ç³»ç»Ÿ`;
            
            // é»˜è®¤æ¿€æ´»ç¬¬ä¸€ä¸ªsection
            activateSection('add-customer');
        }
        
        function activateSection(section) {
            // æ›´æ–°ä¾§è¾¹æ æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.sidebar-btn').forEach(btn => {
                if(btn.classList.contains('sidebar-btn')) {
                    btn.classList.remove('active');
                }
            });
            document.querySelector(`[data-section="${section}"]`).classList.add('active');
            
            // åŠ è½½å¯¹åº”æ–‡æ¡£
            loadDocument(section);
        }
        
        function loadDocument(section) {
            const frame = document.getElementById('document-frame');
            
            // è·å–å½“å‰é—¨åº—å¯¹åº”çš„æ–‡æ¡£URL
            if (currentStore) {
                let docUrl = '';
                
                // æ ¹æ®sectionç¡®å®šURL
                if(section === 'add-customer') {
                    docUrl = CUSTOMER_LINKS[currentStore][0].url;
                } else if(section === 'follow-up') {
                    docUrl = CUSTOMER_LINKS[currentStore][1].url;
                } else if(section === 'review') {
                    docUrl = CUSTOMER_LINKS[currentStore][2].url;
                } else if(section === 'todo') {
                    docUrl = TODO_LINKS[currentStore];
                }
                
                // æ·»åŠ æ—¶é—´æˆ³é˜²æ­¢ç¼“å­˜é—®é¢˜
                const timestamp = new Date().getTime();
                const urlWithTimestamp = `${docUrl}?t=${timestamp}`;
                
                // è®¾ç½®åŠ è½½çŠ¶æ€
                frame.style.display = 'block';
                
                // iframeåŠ è½½é”™è¯¯å¤„ç†
                frame.onerror = function() {
                    console.error('æ–‡æ¡£åŠ è½½å¤±è´¥:', docUrl);
                    frame.src = 'about:blank'; // é‡ç½®iframe
                    setTimeout(() => {
                        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                        frame.style.display = 'none';
                        document.querySelector('.content-area').innerHTML = `
                            <div class="error-message">
                                <h3>æ— æ³•åŠ è½½æ–‡æ¡£</h3>
                                <p>å°è¯•åŠ è½½çš„æ–‡æ¡£é“¾æ¥å¯èƒ½å­˜åœ¨é—®é¢˜ï¼š</p>
                                <p><strong>${docUrl}</strong></p>
                                <p>è¯·æ£€æŸ¥é“¾æ¥æœ‰æ•ˆæ€§æˆ–è”ç³»ç®¡ç†å‘˜è·å–æ­£ç¡®çš„æ–‡æ¡£é“¾æ¥ã€‚</p>
                                <a href="${docUrl}" target="_blank" class="link-button" onclick="window.open('${docUrl}', '_blank'); return false;">å°è¯•åœ¨æ–°çª—å£æ‰“å¼€</a>
                                <button class="footer-btn" style="margin-top: 20px;" onclick="location.reload()">åˆ·æ–°é¡µé¢</button>
                            </div>
                        `;
                    }, 100);
                };
                
                // iframeåŠ è½½å®Œæˆå¤„ç†
                frame.onload = function() {
                    try {
                        frame.style.display = 'block';
                    } catch(e) {
                        console.error('iframeåŠ è½½å¼‚å¸¸:', e);
                    }
                };
                
                // å°è¯•åŠ è½½æ–‡æ¡£
                try {
                    // å…³é”®ä¼˜åŒ–ï¼šä½¿ç”¨ postMessage æˆ–å…¶ä»–æ–¹å¼ä¸å¤–éƒ¨é“¾æ¥é€šä¿¡ï¼ˆå¦‚æœéœ€è¦ï¼‰
                    // ä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç›´æ¥è®¾ç½®srcå³å¯
                    frame.src = urlWithTimestamp;
                } catch(e) {
                    console.error('åŠ è½½æ–‡æ¡£æ—¶å‡ºé”™:', e);
                    frame.style.display = 'none';
                    document.querySelector('.content-area').innerHTML = `
                        <div class="error-message">
                            <h3>åŠ è½½æ–‡æ¡£æ—¶å‘ç”Ÿé”™è¯¯</h3>
                            <p>é”™è¯¯è¯¦æƒ…: ${e.message}</p>
                            <button class="footer-btn" style="margin-top: 20px;" onclick="location.reload()">åˆ·æ–°é¡µé¢</button>
                        </div>
                    `;
                }
            } else {
                frame.src = 'about:blank';
            }
        }
        
        function updatePageBasedOnState() {
            if(currentStore) {
                showDetailPage();
            } else {
                showIndexPage();
            }
        }
        
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const toggleBtn = document.getElementById('toggle-sidebar');
            
            if(sidebar.classList.contains('collapsed')) {
                sidebar.classList.remove('collapsed');
                toggleBtn.textContent = 'Â«';
            } else {
                sidebar.classList.add('collapsed');
                toggleBtn.textContent = 'Â»';
            }
        }
        
        // ç›‘å¬çª—å£å¤§å°å˜åŒ–ï¼Œè°ƒæ•´å¸ƒå±€
        window.addEventListener('resize', function() {
            // åœ¨çª—å£å¤§å°æ”¹å˜æ—¶ä¸éœ€è¦ç‰¹æ®Šå¤„ç†ï¼ŒCSS Flexboxä¼šè‡ªåŠ¨é€‚åº”
        });
    </script>
</body>
</html>